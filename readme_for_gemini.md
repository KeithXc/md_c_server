# Project Context for Gemini

This file provides a quick overview of the "C Markdown Blog" project for Gemini to ensure a smooth continuation of our work in future sessions.

## 1. Project Goal

The primary goal of this project is to create a simple, lightweight, and fast web server entirely in C. Its sole purpose is to find Markdown files (`.md`) in a specific directory, convert them to HTML on the fly, and serve them to a web browser.

## 2. Core Technologies

-   **Language**: C (std=c11)
-   **Build System**: CMake (configured to automatically find all source files in `src/`)
-   **Core Libraries**:
    -   `mongoose`: An embedded web server library used for handling HTTP requests.
    -   `cmark`: A library for parsing Markdown and converting it to HTML.

## 3. Directory Structure

The project is organized into the following directories:

-   `bin/`: **Output** for the final compiled `md_web_server` executable. (Ignored by Git)
-   `build/`: **Temporary files** generated by CMake and the compiler. (Ignored by Git)
-   `md/`: **Content** directory where user places their `.md` files.
-   `src/`: **Source code** directory.
    -   `server.c`: Handles server initialization, socket listening, and routing incoming requests to the correct handler function.
    -   `routes_index.c` / `routes_index.h`: Contains the logic for handling the homepage.
    -   `routes_post.c` / `routes_post.h`: Contains the logic for handling individual post pages.
    -   `utils.c` / `utils.h`: Provides shared utility functions like reading files.
    -   `mongoose.c` / `mongoose.h`: The Mongoose library source files.
-   `static/`: **Static assets** (currently empty).
-   `tmp/`: **Temporary storage** for archives or other non-project files. (Ignored by Git)

## 4. Current Status & Features

As of the last session, the server has the following features implemented:

1.  **Modular Code**: The source code is split into `server.c` (networking/routing), `routes_index.c` (homepage logic), and `routes_post.c` (post page logic). Shared helpers are in `utils.c`.
2.  **Homepage (`/`)**: The server correctly scans the `md/` directory and displays a collapsible, tree-like view of all found `.md` files and subdirectories.
    -   The directory structure is generated as a nested HTML list.
    -   Embedded JavaScript handles the click events to toggle the visibility of subdirectories.
3.  **Post Pages (`/post/*.md`)**: When a user clicks a file link in the tree view:
    -   The server reads the corresponding Markdown file from the `md/` directory.
    -   It wraps the content in a minimal HTML page that includes a "Back to Home" link.
    -   The raw Markdown content is displayed within `<pre>` tags to preserve formatting. (True Markdown-to-HTML conversion is planned for a future step).

## 5. How to Build and Run

The project is built using CMake:

```bash
# 1. Navigate to the build directory (or create it)
cd build

# 2. Generate the Makefile
cmake ..

# 3. Compile the source code
make

# 4. Run the server (the output is in the bin/ directory)
../bin/md_web_server
```
The server will then be accessible at `http://localhost:8000`.
